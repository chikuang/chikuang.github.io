<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Numerical Algorithm and Applications | Optimal Regression Design under Second-Order Least Squares Estimator: Theory, Algorithm and Applications</title>
<meta name="author" content="Chi-Kuang Yeh">
<meta name="description" content="We have studied the optimality conditions and the number of support points for optimal designs under SLSE in Chapter 3. However, it is still challenging to find optimal designs analytically,...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 4 Numerical Algorithm and Applications | Optimal Regression Design under Second-Order Least Squares Estimator: Theory, Algorithm and Applications">
<meta property="og:type" content="book">
<meta property="og:description" content="We have studied the optimality conditions and the number of support points for optimal designs under SLSE in Chapter 3. However, it is still challenging to find optimal designs analytically,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Numerical Algorithm and Applications | Optimal Regression Design under Second-Order Least Squares Estimator: Theory, Algorithm and Applications">
<meta name="twitter:description" content="We have studied the optimality conditions and the number of support points for optimal designs under SLSE in Chapter 3. However, it is still challenging to find optimal designs analytically,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Optimal Regression Design under Second-Order Least Squares Estimator: Theory, Algorithm and Applications</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="chapter-SLSE.html"><span class="header-section-number">3</span> Optimal Regression Designs Under SLSE</a></li>
<li><a class="active" href="chapter-applications.html"><span class="header-section-number">4</span> Numerical Algorithm and Applications</a></li>
<li><a class="" href="chapter:discussions.html"><span class="header-section-number">5</span> Discussions</a></li>
<li><a class="" href="final-words.html"><span class="header-section-number">6</span> Final Words</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chapter-applications" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Numerical Algorithm and Applications<a class="anchor" aria-label="anchor" href="#chapter-applications"><i class="fas fa-link"></i></a>
</h1>
<p>We have studied the optimality conditions and the number of support points for optimal designs under SLSE in Chapter <a href="chapter-SLSE.html#chapter-SLSE">3</a>. However, it is still challenging to find optimal designs analytically, except for simple regression models. Often numerical algorithms are used to compute optimal designs, and various algorithms have been studied including <span class="citation">Titterington (<a href="references.html#ref-titterington1978estimation">1978</a>)</span>, <span class="citation">S. D. Silvey, Titterington, and Torsney (<a href="references.html#ref-silvey1978an">1978</a>)</span>, <span class="citation">Dette, Pepelyshev, and Zhigljavsky (<a href="references.html#ref-dette2008improving">2008</a>)</span>, and <span class="citation">Torsney and Martín-Martín (<a href="references.html#ref-torsney2009multiplicative">2009</a>)</span>. For optimal designs under the SLSE, <span class="citation">Bose and Mukerjee (<a href="references.html#ref-bose2015optimal">2015</a>)</span> used multiplicative algorithms for finding the optimal designs whereas <span class="citation">Gao and Zhou (<a href="references.html#ref-gao2017d">2017</a>)</span> used convex programming and semi-definite programming (SDP) in MATLAB. Here we want to further extend the computational strategies for finding optimal designs under the SLSE. In this chapter, we discuss an effective algorithm to compute optimal designs based on CVX programming in MATLAB.</p>
<div id="optimization-problem" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Optimization problem<a class="anchor" aria-label="anchor" href="#optimization-problem"><i class="fas fa-link"></i></a>
</h2>
<p>We first discretize the design space <span class="math inline">\(S \subset \mathbb{R}^p\)</span>, and the discretized space is denoted as <span class="math inline">\(S_N\subset S\)</span>, where <span class="math inline">\(N\)</span> is the number of points in <span class="math inline">\(S_N\)</span>. The magnitude of <span class="math inline">\(N\)</span> can be very large, but often the designs are highly efficient already with moderate <span class="math inline">\(N\)</span>. More discussions about the choice of <span class="math inline">\(N\)</span> is given in the examples in this chapter The discretization can be done in many different ways, but we discretize the design space using equally spaced gird points for the sake of simplicity. For an one dimensional design space, say <span class="math inline">\(S=[a,b]\)</span>, the design points are <span class="math inline">\(a+(i-1)\frac{(b-a)}{N},i=1,2,...,N\)</span>. For higher dimensional design spaces, we use equally spaced grid points for each variable, and <span class="math inline">\(S_N\)</span> is formed by Cartesian product.</p>
<p>Suppose <span class="math inline">\(\xi^*\)</span> is the optimal probability measure in <span class="math inline">\(\Xi_N\)</span>, where <span class="math inline">\(\Xi_N\)</span> includes all the distributions on <span class="math inline">\(S_N\)</span>. We denote <span class="math inline">\(S_N=\{\boldsymbol{u}_1,\boldsymbol{u}_2,...,\boldsymbol{u}_N\}\subset S\)</span>. Any probability measure <span class="math inline">\(\xi \in \Xi_N\)</span> can be express as
<span class="math display">\[
    \xi=\begin{bmatrix}
    \boldsymbol{u}_1    &amp;\boldsymbol{u}_2   &amp;...&amp;\boldsymbol{u}_N\\
    w_1     &amp;w_2    &amp;...&amp;w_N
    \end{bmatrix},
\]</span></p>
<p>where <span class="math inline">\(w_i\)</span> is the weight at <span class="math inline">\(\boldsymbol{u_i}\)</span>, which is non-negative and <span class="math inline">\(\sum_{i=1}^Nw_i=1\)</span>. The optimal regression design problem can be expressed as
<span class="math display" id="eq:optimization">\[\begin{equation}
\begin{aligned}
&amp; \underset{w_1, ..., w_N, \delta}{\text{min}}
&amp; &amp;  \delta \\
&amp; \text{s.t.}
&amp; &amp; \sum_{i=1}^N w_i=1,\\
&amp; &amp; &amp; -w_i\leq 0,~ \text{for }i = 1,2, ..., N,\\
&amp; &amp; &amp; \phi \leq \delta,
\end{aligned}
\tag{4.1}
\end{equation}\]</span>
where <span class="math inline">\(\phi\)</span> is a loss function, which can be <span class="math inline">\(\phi_A\)</span>, <span class="math inline">\(\log(\phi_D)\)</span> or <span class="math inline">\(\phi_c\)</span> defined in <span class="math inline">\(\eqref{eq:loss-B}\)</span>. Notice that for any <span class="math inline">\(\xi \in \Xi_N\)</span>, <span class="math inline">\(\boldsymbol{B}(\xi,\boldsymbol{\theta}_o,t)=\mathbb{E}_{\xi}[\boldsymbol{M(\boldsymbol{x},\boldsymbol{\theta}_o},t)]=\sum_{i=1}^N \boldsymbol{M}(\boldsymbol{u}_i,\boldsymbol{\theta}_o,t)w_i\)</span>, where <span class="math inline">\(\boldsymbol{M}(\boldsymbol{u_i},\boldsymbol{\theta}_o,t)\)</span> is defined in <a href="chapter-SLSE.html#eq:M-matrix">(3.5)</a>. We also note that a design point is selected if its weight is greater than a very small number <span class="math inline">\(\delta_1\)</span> (a small positive number, say <span class="math inline">\(10^{-5}\)</span>) in practice. Lastly, we report the <span class="math inline">\(d_D^{\max}=\max\{d_D |\boldsymbol{x}\in S\}\)</span> (<span class="math inline">\(d_A^{\max},~d_c^{\max}\)</span>) for D-optimality (A-, c-optimality), where <span class="math inline">\(d_D,d_A\)</span> and <span class="math inline">\(d_c\)</span> are defined in <a href="#eq:dire">(<strong>??</strong>)</a>. If <span class="math inline">\(d_D^{\max}&lt;\delta_2\)</span> (a small positive number, say <span class="math inline">\(10^{-4}\)</span>), then the numerical solution to the above optimization problem is a D-optimal design by Theorem <a href="chapter-SLSE.html#thm:dispersion">3.1</a>. Similarly we can check for A- and c-optimal designs. Problem <a href="chapter-applications.html#eq:optimization">(4.1)</a> is a convex optimization problem. We will discuss an algorithm to solve <a href="chapter-applications.html#eq:optimization">(4.1)</a> in the next section.</p>
</div>
<div id="section-algorithm" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Computational Algorithm<a class="anchor" aria-label="anchor" href="#section-algorithm"><i class="fas fa-link"></i></a>
</h2>
<p>There are some numerical algorithms which have been studied under the SLSE. <span class="citation">Bose and Mukerjee (<a href="references.html#ref-bose2015optimal">2015</a>)</span> applied multiplicative algorithms for finding the optimal designs to binary design points. <span class="citation">Gao and Zhou (<a href="references.html#ref-gao2017d">2017</a>)</span> computed D-optimal designs using the moments of distribution <span class="math inline">\(\xi \in \Xi\)</span>. <span class="citation">Yin and Zhou (<a href="references.html#ref-yin2018optimal">2017</a>)</span> formulated the design problems as convex optimization problem and applied convex optimization programs CVX and SeDuMi in MATLAB to find D- and A-optimal designs, respectively. In their work, the A-optimal design problems are solved by SeDuMi which is hard to write the code in MATLAB. In our newly proposed formulation in <a href="chapter-applications.html#eq:optimization">(4.1)</a>, we are able to use CVX to find A-optimal designs, which is much easier to code. Moreover, the CVX programming can be also applied to find c-optimal designs, which the previous algorithms were not applied before.</p>
<p>Figure <span class="math inline">\(\ref{Flow chart}\)</span> illustrates a simple algorithm with six steps to apply CVX for finding optimal designs. Users input the variables, partition the design space into <span class="math inline">\(N\)</span> grid points, and compute the <span class="math inline">\(\boldsymbol{M}\)</span> matrix in the first three steps. Steps (i), (ii) and (iii) depend on the regression model and the design space. Step (iv) solves the optimal design problem by CVX program, which depends on the optimality criterion. The details of using CVX and MATLAB code can be found in Appendix <span class="math inline">\(\ref{appendix:algorithm}\)</span> and Appendix <span class="math inline">\(\ref{appendix:matlab}\)</span>. We present several examples using this algorithm to show optimal designs in Section <a href="chapter-applications.html#section:applications">4.3</a>.</p>
</div>
<div id="section:applications" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Applications<a class="anchor" aria-label="anchor" href="#section:applications"><i class="fas fa-link"></i></a>
</h2>
<p>We compute A-, D- and c-optimal designs for various regression models. Notice that when the intercept term presents, the resulting optimal designs under the OLSE and the SLSE are the same <span class="citation">Gao and Zhou (<a href="references.html#ref-gao2014new">2014</a>)</span>. Since there are many studies in optimal regression designs under the OLSE in the literature already, we only consider the models without the intercept. All the examples are computed via CVX package in MATLAB. We provide the results with different values of <span class="math inline">\(t\)</span>, where <span class="math inline">\(t\)</span> is related to a measure of skewness of the error distribution. The related MATLAB code can be found in Appendix <span class="citation">(<a href="#ref-appendix:matlab"><strong>appendix:matlab?</strong></a>)</span>.</p>
<p>All the examples in this thesis are computed on a PC with Intel Core I5 6500 4 cores CPU, 3.20 GHz. The MATLAB version is R2018a academic student version with CVX version 2.1 and build number 1123. The RAM and the platform for this particular machine are 16 Gigabyte and Windows 10 Professional version, respectively.</p>
<div class="example">
<p><span id="exm:gompertz" class="example"><strong>Example 4.1  </strong></span>This example is for Gompertz growth model which was briefly described in Chapter <a href="#chapter:introduction"><strong>??</strong></a> to showcase the output. Here, we use this model to show the effects of N on the D-optimal designs under SLSE with <span class="math inline">\(\boldsymbol{\theta_o}=(1,1,1)^\top\)</span>, <span class="math inline">\(S=[0.0,10.0]\)</span> and <span class="math inline">\(t=0\)</span>.</p>
<p>Table <span class="math inline">\(\ref{table:gompertz1}\)</span> gives D-optimal designs for various values of <span class="math inline">\(N\)</span>. Note that the D-optimal design in Figure <span class="math inline">\(\ref{fig:gompertz}\)</span> in Chapter <span class="math inline">\(\ref{chapter:introduction}\)</span> is for <span class="math inline">\(N=2001\)</span>. We can see that the optimal design changes when <span class="math inline">\(N\)</span> increases. However, when <span class="math inline">\(N\ge 1001\)</span>, the optimal designs do not change much and converge to a distribution having three support points with equal weights. We also show the change of the loss function as <span class="math inline">\(N\)</span> changes in Figure <span class="math inline">\(\ref{fig:gom_loss}\)</span>. As <span class="math inline">\(N\rightarrow +\infty\)</span>, the loss function converges too. In this example, moderate <span class="math inline">\(N\)</span> already gives a highly efficient design as shown in Figure <span class="math inline">\(\ref{fig:gom_loss}\)</span>. Similar results are obtained for A- and c-optimal designs, and representative results are given in Table <span class="math inline">\(\ref{table:gompertz2}\)</span>, where <span class="math inline">\(\boldsymbol{c_1}=(2,0.5,1)^T\)</span> is used for c-optimal designs, and <span class="math inline">\(t= 0.0, 0.3, 0.5, 0.7\)</span> and <span class="math inline">\(0.9\)</span>.</p>
<p>It is clear that <span class="math inline">\(d_A^{\max}=\max\limits_{x}(d_A(x,\xi_A^*,t)\)</span> (or <span class="math inline">\(d_c(x,\xi_c^*,t)\)</span>) is small, which satisfies the optimality conditions in Theorem <span class="math inline">\(\ref{theorem:dispersion}\)</span>. We should also point out that for some situations when two numerical support points are very close to each other, they are probably representing only one theoretical support point which is between the two numerical support points. For instance, when <span class="math inline">\(t=0.0\)</span>, the two support points <span class="math inline">\(1.315\)</span> and <span class="math inline">\(1.320\)</span> are very close to each other in A-optimal design. If we discretize the design space to more points (i.e. choose larger <span class="math inline">\(N\)</span>), we can find this particular point. For instance, the A-optimal design with <span class="math inline">\(N=9001\)</span> is</p>
<p><span class="math display">\[
    \xi_A^*=\begin{bmatrix}
                0.000   &amp;   1.318   &amp;   10.000\\
                0.354   &amp;   0.385   &amp;   0.261
    \end{bmatrix},
\]</span>
which only has three support points and <span class="math inline">\(1.318\)</span> is indeed in between <span class="math inline">\(1.315\)</span> and <span class="math inline">\(1.320\)</span>.
The computational time changes from 1.65 seconds to 86.16 seconds for <span class="math inline">\(N=51\)</span> to <span class="math inline">\(N=20001\)</span>, which increases quite a bit but the computational time is still less than two minutes.
<span class="math inline">\(\Box\)</span></p>
</div>
<div class="example">
<p><span id="exm:polynomial" class="example"><strong>Example 4.2  </strong></span>We consider the polynomial regression model in <span class="math inline">\(\eqref{model:poly}\)</span> with <span class="math inline">\(q=5\)</span>. Here <span class="math inline">\(\mathbf{f}(x;\mathbf{\theta}) = (x,x^2,... ,x^q)^\top\)</span> which does not depend on <span class="math inline">\(\mathbf{\theta}\)</span>. The A- and D-optimal designs are shown in Figure <span class="math inline">\(\ref{fig:poly_5}\)</span>. With <span class="math inline">\(N=2001\)</span>, we can see that the number of support points is always six for this model. When <span class="math inline">\(q\)</span> is even, the number of support points for D- and A-optimal designs equals to <span class="math inline">\(q\)</span> for small <span class="math inline">\(t\)</span>, and equals to <span class="math inline">\(q+1\)</span> for larger <span class="math inline">\(t\)</span>. This is consistent with Theorem <span class="math inline">\(\ref{theorem:support}\)</span>.</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chapter-SLSE.html"><span class="header-section-number">3</span> Optimal Regression Designs Under SLSE</a></div>
<div class="next"><a href="chapter:discussions.html"><span class="header-section-number">5</span> Discussions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chapter-applications"><span class="header-section-number">4</span> Numerical Algorithm and Applications</a></li>
<li><a class="nav-link" href="#optimization-problem"><span class="header-section-number">4.1</span> Optimization problem</a></li>
<li><a class="nav-link" href="#section-algorithm"><span class="header-section-number">4.2</span> Computational Algorithm</a></li>
<li><a class="nav-link" href="#section:applications"><span class="header-section-number">4.3</span> Applications</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Optimal Regression Design under Second-Order Least Squares Estimator: Theory, Algorithm and Applications</strong>" was written by Chi-Kuang Yeh. It was last built on 2024-05-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
