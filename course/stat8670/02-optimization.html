<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Numerical Approaches and Optimization â€“ STAT 8670 - Computational Methods in Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-resampling.html" rel="next">
<link href="./01-intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e4baa099099b77f7feedd108bf77a49f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom-callouts.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STAT 8670 - Computational Methods in Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/chikuang/Teaching-Stat8670"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="././STAT-8670---Computational-Methods-in-Statistics.pdf"> <i class="bi bi-file-pdf" role="img" aria-label="Download PDF">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-optimization.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical Approaches and Optimization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Structure and R Programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-optimization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical Approaches and Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-resampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Resampling, Jackknife and Bootstrap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Additional Topics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-A-intro-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Appendix: Introduction to R?</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#theory-versus-computation" id="toc-theory-versus-computation" class="nav-link active" data-scroll-target="#theory-versus-computation"><span class="header-section-number">2.1</span> Theory versus Computation</a></li>
  <li><a href="#matrix-inversion" id="toc-matrix-inversion" class="nav-link" data-scroll-target="#matrix-inversion"><span class="header-section-number">2.2</span> Matrix Inversion</a>
  <ul class="collapse">
  <li><a href="#example-1-normal-distribution" id="toc-example-1-normal-distribution" class="nav-link" data-scroll-target="#example-1-normal-distribution"><span class="header-section-number">2.2.1</span> Example 1: Normal distribution</a></li>
  <li><a href="#example-2-linear-regression" id="toc-example-2-linear-regression" class="nav-link" data-scroll-target="#example-2-linear-regression"><span class="header-section-number">2.2.2</span> Example 2: Linear regression</a></li>
  <li><a href="#take-home-message" id="toc-take-home-message" class="nav-link" data-scroll-target="#take-home-message"><span class="header-section-number">2.2.3</span> Take home message:</a></li>
  <li><a href="#multi-collinearity" id="toc-multi-collinearity" class="nav-link" data-scroll-target="#multi-collinearity"><span class="header-section-number">2.2.4</span> Multi-collinearity</a></li>
  <li><a href="#trade-off" id="toc-trade-off" class="nav-link" data-scroll-target="#trade-off"><span class="header-section-number">2.2.5</span> Trade-off</a></li>
  <li><a href="#multivariate-normal-revisit" id="toc-multivariate-normal-revisit" class="nav-link" data-scroll-target="#multivariate-normal-revisit"><span class="header-section-number">2.2.6</span> Multivariate Normal revisit</a></li>
  </ul></li>
  <li><a href="#nonlinear-functions" id="toc-nonlinear-functions" class="nav-link" data-scroll-target="#nonlinear-functions"><span class="header-section-number">2.3</span> Nonlinear functions</a></li>
  <li><a href="#type-of-optimization-algorithms" id="toc-type-of-optimization-algorithms" class="nav-link" data-scroll-target="#type-of-optimization-algorithms"><span class="header-section-number">2.4</span> Type of Optimization Algorithms</a></li>
  <li><a href="#deterministic-algorithms" id="toc-deterministic-algorithms" class="nav-link" data-scroll-target="#deterministic-algorithms"><span class="header-section-number">2.5</span> Deterministic Algorithms</a>
  <ul class="collapse">
  <li><a href="#root-finding" id="toc-root-finding" class="nav-link" data-scroll-target="#root-finding"><span class="header-section-number">2.5.1</span> Root finding</a></li>
  <li><a href="#one-dimensional-case" id="toc-one-dimensional-case" class="nav-link" data-scroll-target="#one-dimensional-case"><span class="header-section-number">2.5.2</span> One-dimensional case</a></li>
  <li><a href="#bisection-method" id="toc-bisection-method" class="nav-link" data-scroll-target="#bisection-method"><span class="header-section-number">2.5.3</span> Bisection method</a></li>
  <li><a href="#newton-raphson-method" id="toc-newton-raphson-method" class="nav-link" data-scroll-target="#newton-raphson-method"><span class="header-section-number">2.5.4</span> Newton-Raphson method</a></li>
  <li><a href="#second-method" id="toc-second-method" class="nav-link" data-scroll-target="#second-method"><span class="header-section-number">2.5.5</span> Second Method</a></li>
  <li><a href="#multivariate-case" id="toc-multivariate-case" class="nav-link" data-scroll-target="#multivariate-case"><span class="header-section-number">2.5.6</span> Multivariate Case</a></li>
  </ul></li>
  <li><a href="#heuristic-algorithms" id="toc-heuristic-algorithms" class="nav-link" data-scroll-target="#heuristic-algorithms"><span class="header-section-number">2.6</span> Heuristic Algorithms</a>
  <ul class="collapse">
  <li><a href="#in-r" id="toc-in-r" class="nav-link" data-scroll-target="#in-r"><span class="header-section-number">2.6.1</span> In R</a></li>
  <li><a href="#em-algorithm" id="toc-em-algorithm" class="nav-link" data-scroll-target="#em-algorithm"><span class="header-section-number">2.6.2</span> EM Algorithm</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical Approaches and Optimization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The optimization plays an important role in statistical computing, especially in the context of maximum likelihood estimation (MLE) and other statistical inference methods. This chapter will cover various optimization techniques used in statistical computing.</p>
<p>There is a general principle that will be repeated in this chapter that Kenneth Lange calls <em>optimization transfer</em> in his 1999 paper. The basic idea applies to the problem of maximizing a function <span class="math inline">\(f\)</span>.</p>
<ol type="1">
<li>Direct optimize the function <span class="math inline">\(f\)</span>.
<ul>
<li>It can be difficult</li>
</ul></li>
<li>Optimize a surrogate function <span class="math inline">\(g\)</span> that is easier to optimize than <span class="math inline">\(f\)</span>.</li>
<li>So here, instead of optimize <span class="math inline">\(f\)</span>, we optimize <span class="math inline">\(g\)</span>.</li>
</ol>
<p>Note 1: steps 2&amp;3 are repeated until convergence.</p>
<p>Note 2: maximizing <span class="math inline">\(f\)</span> is equivalent to minimizing <span class="math inline">\(-f\)</span>.</p>
<p>Note 3: the surrogate function <span class="math inline">\(g\)</span> should be chosen such that it is easier to optimize than <span class="math inline">\(f\)</span>.</p>
<p>For instance, for a linear regression <span class="math display">\[\begin{equation}
  y = X\boldsymbol{\beta} + \varepsilon. \label{eq:linmod}
\end{equation}\]</span></p>
<p>From regression class, we know that the (ordinary) least-squares estimation (OLE) for <span class="math inline">\(\boldsymbol{\beta}\)</span> is given by <span class="math inline">\(\hat{\boldsymbol{\beta}}=(X^\top X)^{-1} X^\top y\)</span>. It is convenient as the solution is in the <strong>closed-form</strong>! However, in the most case, the closed-form solutions will not be available.</p>
<p>For GLMs or non-linear regression, we need to do this <strong>iterativelly</strong>!</p>
<section id="theory-versus-computation" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="theory-versus-computation"><span class="header-section-number">2.1</span> Theory versus Computation</h2>
<p>One confusing aspect of statistical computing is that often there is a disconnect between what is printed in a statistical computing textbook and what should be implemented on the computer.</p>
<ul>
<li>In textbooks, simpler to <strong>present solutions as convenient mathematical formulas whenever possible</strong>, in order to communicate basic ideas and to provide some insight.
<ul>
<li>However, directly translating these formulas into computer code is usually not advisable because there are many problematic aspects of computers that are simply not relevant when writing things down on paper.</li>
</ul></li>
</ul>
<p>Some potential issues includ:</p>
<ol type="1">
<li><p>Memory overflow: The computer has a limited amount of memory, and it is possible to run out of memory when working with large datasets or complex models.</p></li>
<li><p>Numerical Precision: Sometimes, due to the cut precision of floating-point arithmetic, calculations that are mathematically equivalent can yield different results on a computer.</p>
<ul>
<li>Example 1: round <span class="math inline">\(1/3\)</span> to two decimal places, we get <span class="math inline">\(0.33\)</span>. Then, <span class="math inline">\(3 \cdot (1/3)\)</span> is exactly <span class="math inline">\(1\)</span>, but <span class="math inline">\(3 \cdot 0.33\)</span> is <span class="math inline">\(0.99\)</span>.</li>
<li>Example 2: <span class="math inline">\(1 - 0.99999999\)</span> is <span class="math inline">\(0.00000001\)</span> (=1E-8), but if we round <span class="math inline">\(0.99999999\)</span> to two decimal places, we get <span class="math inline">\(1.00\)</span>, and then <span class="math inline">\(1 - 1.00\)</span> is <span class="math inline">\(0\)</span>. If we round <span class="math inline">\(0.00000001\)</span> to two decimal places, we get <span class="math inline">\(0.00\)</span>.</li>
<li>Example 3: <span class="math inline">\(\pi\)</span></li>
</ul></li>
<li><p>(Lienar) Dependence: The detection of linear dependence in matrix computations is influenced by machine precision. Since computers operate with finite precision, situations often arise where true linear dependence exists, but the computer cannot distinguish it from independence.</p>
<ul>
<li>Example: Consider the matrix <span class="math display">\[
A = \begin{pmatrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9 \\
\end{pmatrix}
\]</span> The 3rd column is a linear combination of the first two columns (i.e., col3 = col1 + col2). However, due to machine precision limitations, the computer might not recognize this exact linear dependence, leading to numerical instability in computations involving this matrix. With a small distortion, we have <span class="math display">\[
B = \begin{pmatrix}
1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9 + 10^{-5} \\
\end{pmatrix}
\]</span></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> A</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>B[<span class="dv">3</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> B[<span class="dv">3</span>, <span class="dv">3</span>] <span class="sc">+</span> <span class="fl">1E-5</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(A)<span class="sc">$</span>rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(B)<span class="sc">$</span>rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section>
<section id="matrix-inversion" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="matrix-inversion"><span class="header-section-number">2.2</span> Matrix Inversion</h2>
<p>In many statistical analyses, such as linear regression and specify the distribution (such as normal distribution), matrix inversion plays a central role.</p>
<section id="example-1-normal-distribution" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="example-1-normal-distribution"><span class="header-section-number">2.2.1</span> Example 1: Normal distribution</h3>
<p>We know that, a normal density with the parameters mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> is <span class="math display">\[
f\left(x \mid \mu, \sigma^2\right)=\frac{1}{\sqrt{2 \pi} \sigma} \exp\left\{-\frac{1}{2 \sigma^2}(x-\mu)^2\right\}
\]</span> or we may work on the multivariate normal distribution case which is a bit more involved.</p>
<div class="callout-definition" title="Multivariate normal distribution">
<p><span class="math inline">\(\boldsymbol{X} = (X1,\dots, X_d)\)</span> is said to be a multivariate normal distribution if and only if it is a linear comibnation of independent and identically distributed standard normals: <span class="math display">\[
\boldsymbol{X} = \boldsymbol{CZ} + \mu,\quad \boldsymbol{Z}=(Z_1,\dots,Z_d),\quad Z_i \stackrel{iid}{\sim} N(0,1).
\]</span></p>
</div>
<p>The property of the multivariate normal are:</p>
<ul>
<li>mean vector: <span class="math inline">\(E(\boldsymbol{X}) = \mu\)</span></li>
<li>variance: <span class="math inline">\(Var(\boldsymbol{X}) = \boldsymbol{CZC}^\top = \boldsymbol{C} var(\boldsymbol{Z})\boldsymbol{C}^\top:=  \boldsymbol{\Sigma}\)</span></li>
</ul>
<p>Notation: <span class="math inline">\(\boldsymbol{X} \sim N(\mu, \boldsymbol{\Sigma})\)</span>.</p>
<p>PDF: <span class="math display">\[
f(\boldsymbol{x} \mid \mu, \Sigma)=(2 \pi)^{-d / 2} \cdot \exp \left\{-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^{\prime} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x}-\boldsymbol{\mu})-\frac{1}{2} \log |\boldsymbol{\Sigma}|\right\}.
\]</span> Some of the potential ways to do this is to take logarithm of the PDF (Think about why).</p>
</section>
<section id="example-2-linear-regression" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="example-2-linear-regression"><span class="header-section-number">2.2.2</span> Example 2: Linear regression</h3>
<p>Recall the linear regression model . The OLE for <span class="math inline">\(\boldsymbol{\beta}\)</span> is given by <span class="math inline">\(\hat{\boldsymbol{\beta}}=(X^\top X)^{-1} X^\top y\)</span>.</p>
<p>We can solve this using the R command</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where <code>solve()</code> is the R function for matrix inversion. However, it is not a desired way (think about why).</p>
<p>A better way is to go back to the formula, and look at <span class="math display">\[
X^\top X\boldsymbol{\beta}= X^\top y,
\]</span> and solve this using the R command</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>( <span class="fu">crossprod</span>(X), <span class="fu">crossprod</span>(X, y) ) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the same as </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(t(X) %*% X, t(X) %*% y)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, we avoid explicitly calculating the inverse of <span class="math inline">\(X^\top X\)</span>. Instead, we use gaussian elimination to solve the system of equations, which is generally more numerically stable and efficient.</p>
<section id="speed-comparison" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="speed-comparison"><span class="header-section-number">2.2.2.1</span> Speed comparison</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025-09-03</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">5000</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="dv">5000</span>, <span class="dv">100</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5000</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Unit: milliseconds
                             expr      min       lq
 solve(t(X) %*% X) %*% t(X) %*% y 28.83505 30.16593
     mean   median       uq      max neval
 31.96782 30.79489 32.63315 111.0151   100
Warning message:
In microbenchmark(solve(t(X) %*% X) %*% t(X) %*% y) :
  less accurate nanosecond times to avoid potential integer overflows</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">solve</span>(<span class="fu">crossprod</span>(X), <span class="fu">crossprod</span>(X, y)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Unit: milliseconds
                                 expr      min       lq
     solve(t(X) %*% X) %*% t(X) %*% y 28.90135 30.11608
 solve(crossprod(X), crossprod(X, y)) 25.05859 25.27480
     mean   median       uq      max neval
 31.78686 31.38513 32.66482 53.03354   100
 26.15771 25.81678 26.89188 29.12045   100</code></pre>
</section>
</section>
<section id="take-home-message" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="take-home-message"><span class="header-section-number">2.2.3</span> Take home message:</h3>
<p>The take home here is that the issues arise from the finite precision of computer arithmetic and the limited memory available on computers. When implementing statistical methods on a computer, it is crucial to consider these limitations and choose algorithms and implementations that are robust to numerical issues.</p>
</section>
<section id="multi-collinearity" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="multi-collinearity"><span class="header-section-number">2.2.4</span> Multi-collinearity</h3>
<p>The above approach may break down when there is any multi-colinearity in the <span class="math inline">\(\boldsymbol{X}\)</span> matrix. For example, we can tack on a column to <span class="math inline">\(\boldsymbol{X}\)</span> that is very similar (but not identical) to the first column of <span class="math inline">\(\boldsymbol{X}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N <span class="sc">*</span> K), N, K)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X, X[, <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="fl">1E-15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">crossprod</span>(W), <span class="fu">crossprod</span>(W, y))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="st">`</span><span class="at">solve.default()</span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> system is computationally singular<span class="sc">:</span> reciprocal condition number <span class="ot">=</span> <span class="fl">1.36748e-32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The algorithm does not work because the cross product matrix <span class="math inline">\(W^\top W\)</span> is <strong>singular</strong>. In practice, matrices like these can come up a lot in data analysis and it would be useful to have a way to deal with it automatically.</p>
<p>R takes a different approach to solving for the unknown coefficients in a linear model. R uses the QR decomposition, which is not as fast, but has the added benefit of being able to automatically detect and handle colinear columns in the matrix.</p>
<p>Here, we use the fact that X can be decomposed as <span class="math inline">\(\boldsymbol{X}=QR\)</span>, where <span class="math inline">\(Q\)</span> is an orthonormal matrix and <span class="math inline">\(R\)</span> is an upper triangular matrix. Given that, we can rewrite <span class="math inline">\(X^\top X \boldsymbol{\beta}= X^\top y\)</span> as <span class="math display">\[\begin{align*}
R^\top Q^\top Q R \boldsymbol{\beta}&amp;= R^\top Q^\top y\\
R^\top I R \boldsymbol{\beta}&amp;= R^\top Q^\top y\\
R^\top R \boldsymbol{\beta}&amp;= R^\top Q^\top y,
\end{align*}\]</span> this leads to <span class="math inline">\(R\boldsymbol{\beta}= Q^\top y\)</span>. Now we can perform the Gaussian elimination to do it. Because <span class="math inline">\(R\)</span> is an upper triangular matrix, the computational speed is much faster. Here, we <strong>avoid to compute the cross product</strong> <span class="math inline">\(X^\top X\)</span>, which is numerical unstable if it is not <em>standardized</em> properly</p>
<p>We can see in R code that even with our singular matrix <span class="math inline">\(W\)</span> above, the QR decomposition continues without error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Qw <span class="ot">&lt;-</span> <span class="fu">qr</span>(W)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Qw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ qr   : num [1:3000, 1:101] 54.43933 0.00123 -0.02004 -0.00671 -0.00178 ...
 $ rank : int 100
 $ qraux: num [1:101] 1.01 1.01 1.01 1 1 ...
 $ pivot: int [1:101] 1 2 3 4 5 6 7 8 9 10 ...
 - attr(*, "class")= chr "qr"</code></pre>
</div>
</div>
<p>Note that the output of <code>qr()</code> computes the rank of <span class="math inline">\(W\)</span> to be 100, not 101 as the last column is collinear to the 1st column. From there, we can get <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> if we want using <code>qr.coef()</code>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>betahat <span class="ot">&lt;-</span> <span class="fu">qr.coef</span>(Qw, y)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(betahat, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.024314718  0.000916951 -0.005980588</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(betahat, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.01545039 -0.01010440          NA</code></pre>
</div>
</div>
<p>Q: Why there is an <code>NA</code>?</p>
</section>
<section id="trade-off" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="trade-off"><span class="header-section-number">2.2.5</span> Trade-off</h3>
<p>There isnâ€™t always elegance and flourish. When we take the robust approach, we accept that it comes at a cost.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">solve</span>(<span class="fu">crossprod</span>(X), <span class="fu">crossprod</span>(X, y)),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">qr.coef</span>(<span class="fu">qr</span>(X), y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in microbenchmark(solve(t(X) %*% X) %*% t(X) %*% y, solve(crossprod(X),
: less accurate nanosecond times to avoid potential integer overflows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Compared with the approaches discussed above, this method performs similarly to the naive approach but is much more stable and reliable.</p>
<p>In practice, we rarely call functions such as <code>qr()</code> or <code>qr.coef()</code> directly, since higher-level functions like lm() handle these computations automatically. However, in certain specialized and performance-critical settings, it can be advantageous to use alternative matrix decompositions to compute regression coefficients, especially when the computation must be repeated many times in a loop (i.e., <em>Vectorization</em>)</p>
</section>
<section id="multivariate-normal-revisit" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="multivariate-normal-revisit"><span class="header-section-number">2.2.6</span> Multivariate Normal revisit</h3>
<p>Computing the multivariate normal (MVN) density is a common task, for example, when fitting spatial models or Gaussian process models. Because maximum likelihood estimation(MLE) and likelihood ratio tests (LRT) often require evaluating the likelihood many times, efficiency is crucial.</p>
<p>After taking the log of the MVN density, we have</p>
<p><span class="math display">\[
\ell(\boldsymbol{x}\mid \boldsymbol{\mu},\Sigma) := \log \left\{ f(\boldsymbol{x}\mid \boldsymbol{\mu},\Sigma) \right\}
= -\frac{d}{2}\log(2\pi) - \frac{1}{2}\log|\Sigma| - \frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^\top \Sigma^{-1}(\boldsymbol{x}-\boldsymbol{\mu}).
\]</span> On the right hand side, the first term is a constant, the second term is linear, and the last term is quadratic, which requires much more computational power.</p>
<section id="a-naive-implementation" class="level4" data-number="2.2.6.1">
<h4 data-number="2.2.6.1" class="anchored" data-anchor-id="a-naive-implementation"><span class="header-section-number">2.2.6.1</span> A Naive Implementation</h4>
<p>We first center the data <span class="math inline">\(\boldsymbol{z}:=\boldsymbol{x}- \mu\)</span>. Then we have <span class="math inline">\(\boldsymbol{z}^\top \Sigma^{-1} \boldsymbol{z}\)</span>. This simiplified the question for a bit.</p>
<p>Here, much like the linear regression example above, the key bottleneck is the inversion of the <span class="math inline">\(p\)</span>-dimensional covariance matrix <span class="math inline">\(\Sigma\)</span>. If we take <span class="math inline">\(\boldsymbol{z}\)</span> to be a <span class="math inline">\(p\times 1\)</span> column vector, then a literal translation of the mathematics into R code might look something like this,</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(z) <span class="sc">%*%</span> <span class="fu">solve</span>(Sigma) <span class="sc">%*%</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To illustrate, letâ€™s simulate some data and compute the quadratic form the naive way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025-09-03</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">200</span> <span class="sc">*</span> <span class="dv">100</span>), <span class="dv">200</span>, <span class="dv">100</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(z)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive quadratic form</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>quad.naive <span class="ot">&lt;-</span> <span class="cf">function</span>(z, S) {</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  Sinv <span class="ot">&lt;-</span> <span class="fu">solve</span>(S)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>((z <span class="sc">%*%</span> Sinv) <span class="sc">*</span> z)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">quad.naive</span>(z, S) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  70.67   93.61   99.94  100.54  107.31  126.73 </code></pre>
</div>
</div>
</section>
<section id="a-better-way-cholesky-decomposition" class="level4" data-number="2.2.6.2">
<h4 data-number="2.2.6.2" class="anchored" data-anchor-id="a-better-way-cholesky-decomposition"><span class="header-section-number">2.2.6.2</span> A Better Way: Cholesky Decomposition</h4>
<p>Because the covariance matrix is symmetric and positive definite, we can exploit its <strong>Cholesky decomposition</strong>. That is, we write <span class="math inline">\(\Sigma = R^\top R\)</span>, where <span class="math inline">\(R\)</span> is a upper triangular matrix. Then, <span class="math display">\[
\boldsymbol{z}^\top \Sigma^{-1} \boldsymbol{z}= \boldsymbol{z}^\top (R^\top R)^{-1} \boldsymbol{z}= \boldsymbol{z}^\top R^{-1}R^{-\top} \boldsymbol{z}= (R^{-\top}\boldsymbol{z})^\top (R^{-\top} \boldsymbol{z}) := \boldsymbol{v}^\top \boldsymbol{v}.
\]</span> Note that <span class="math inline">\(\boldsymbol{v}\in \mathbb R^p\)</span> is the solution to the linear system <span class="math inline">\(R^\top \boldsymbol{v}= \boldsymbol{z}\)</span>. Because <span class="math inline">\(R\)</span> is upper triangular, we can solve this system efficiently using back substitution. Also, we can solve this without doing the inversion.</p>
<p>Once we have <span class="math inline">\(\boldsymbol{v}\)</span> we can compute its quadratic form <span class="math inline">\(\boldsymbol{v}^\top \boldsymbol{v}\)</span> by the <code>crossprod()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>quad.chol <span class="ot">&lt;-</span> <span class="cf">function</span>(z, S) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">chol</span>(S)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">backsolve</span>(R, <span class="fu">t</span>(z), <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(v <span class="sc">*</span> v)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quad.chol</span>(z, S) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  70.67   93.61   99.94  100.54  107.31  126.73 </code></pre>
</div>
</div>
</section>
<section id="by-product" class="level4" data-number="2.2.6.3">
<h4 data-number="2.2.6.3" class="anchored" data-anchor-id="by-product"><span class="header-section-number">2.2.6.3</span> By product</h4>
<p>Another benefit of the Cholesky decomposition is that it gives us a simple way to compute the log-determinant of <span class="math inline">\(\Sigma\)</span>. The log-determinant of <span class="math inline">\(\Sigma\)</span> is simply two times the sum of the log of the diagonal elements of R. (Why?)</p>
</section>
<section id="performance-comparison" class="level4" data-number="2.2.6.4">
<h4 data-number="2.2.6.4" class="anchored" data-anchor-id="performance-comparison"><span class="header-section-number">2.2.6.4</span> Performance comparison</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">naive =</span> <span class="fu">quad.naive</span>(z, S),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">chol  =</span> <span class="fu">quad.chol</span>(z, S)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Q: Why one is faster than the other?</p>
</section>
<section id="take-home-message-2" class="level4" data-number="2.2.6.5">
<h4 data-number="2.2.6.5" class="anchored" data-anchor-id="take-home-message-2"><span class="header-section-number">2.2.6.5</span> Take home message 2</h4>
<p>The naive algorithm simply inverts the covariance matrix. The Cholesky-based approach, on the other hand, exploits the fact that covariance matrices are symmetric and positive definite. This results in an implementation that is both faster and numerically more stableâ€”exactly the kind of optimization that makes a difference in real-world statistical computing.</p>
<p>Thus, a knowledge of statistics and numerical analysis can often lead to better algorithms, often invaluable!</p>
<hr>
</section>
</section>
</section>
<section id="nonlinear-functions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="nonlinear-functions"><span class="header-section-number">2.3</span> Nonlinear functions</h2>
<p>On the top, we have <em>linear functions</em>, such as <span class="math inline">\(y=f(x) = ax + b\)</span> or in the linear regression <span class="math inline">\(y=X\beta +\epsilon\)</span>. It is a small class of the functions, and may be relatively limited.</p>
<p>E.g., what if we have a quadratic relationship? Then <span class="math inline">\(y=f(x) = ax^2 + bx + c\)</span>.</p>
<p>Such nonlinear relationship is very common, , such as <span class="math inline">\(f(x) = a\sin(bx + c)\)</span> or <span class="math inline">\(f(x) = a\exp(bx) + c\)</span>, and they may not have a closed-form solution like in the linear regression case.</p>
<p>From now on, we will be talking about the numerical approaches to solve these problems.</p>
</section>
<section id="type-of-optimization-algorithms" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="type-of-optimization-algorithms"><span class="header-section-number">2.4</span> Type of Optimization Algorithms</h2>
<p>There are in general two types of the optimization algorithms: (1). <strong>deterministic</strong> and (2). <strong>metaheuristic</strong>. Deterministic and metaheuristic algorithms represent two distinct paradigms in optimization.</p>
<p>*. <strong>Deterministic methods</strong>: such as gradient descent, produce the same solution for a given input and follow a predictable path toward an optimum.</p>
<p>*. In contrast, <strong>metaheuristic approaches</strong>: incorporate randomness and do not guarantee the best possible solution. However, they are often more effective at avoiding local optima and exploring complex search spaces.</p>
</section>
<section id="deterministic-algorithms" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="deterministic-algorithms"><span class="header-section-number">2.5</span> Deterministic Algorithms</h2>
<p>Numerical approximation, what you learned in the mathematical optimization course. Some of the algorithms include:</p>
<ul>
<li>Gradient Descent</li>
<li>Newtonâ€™s Method</li>
<li>Conjugate Gradient Method</li>
<li>Quasi-Newton Methods (e.g., BFGS)</li>
<li>Interior Point Methods</li>
</ul>
<p>They often rely on the <strong>Karushâ€“Kuhnâ€“Tucker</strong> (KKT) conditions.</p>
<section id="root-finding" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="root-finding"><span class="header-section-number">2.5.1</span> Root finding</h3>
<p>The <em>root finding</em> is probably the first numerical approach you learned in the numerical analysis course. Consider a function <span class="math inline">\(f: \mathbb R\to \mathbb R\)</span>. The point <span class="math inline">\(x\in \mathbb R\)</span> is called a <em>root</em> of <span class="math inline">\(f\)</span> if <span class="math inline">\(f(x) = 0\)</span>.</p>
<p>Q: Why do we care about the root finding?</p>
<p>This idea has broad applications. While finding the values of x such that f(x) = 0 is useful in many settings, a more general task is to determine the values of x for which f(x) = y. The same techniques used to find the roots of a function can be applied here by rewriting the problem as <span class="math display">\[
\tilde{f}(x) := f(x) - y = 0.
\]</span> In this way, new function <span class="math inline">\(\tilde{f}(x)\)</span> has a root at the solution to, <span class="math inline">\(f(x)=y\)</span>, original equation.</p>
<p>For linear function, it is trivial. For quadratic function, we can use the quadratic formula, i.e., <span class="math display">\[
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}.
\]</span> However, for more complex functions, we need to use numerical methods to solve it iteratively. Below, we are going to go over some numerical algorithms.</p>
</section>
<section id="one-dimensional-case" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="one-dimensional-case"><span class="header-section-number">2.5.2</span> One-dimensional case</h3>
<p>We first look at the one-dimensional case. The function we want to optimize is</p>
<p><span class="math display">\[f(x) = x^3 - x + 1\]</span></p>
</section>
<section id="bisection-method" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="bisection-method"><span class="header-section-number">2.5.3</span> Bisection method</h3>
<p>Bisection method is just like a <em>binary search</em>.</p>
<div class="callout-algorithm" title="Bisection Method">
<p><strong>Step 1.</strong> Selection two points <span class="math inline">\(a,b\in \chi \subseteq \mathbb R\)</span>, where <span class="math inline">\(\chi\)</span> is the domain of <span class="math inline">\(f\)</span>. Make sure that <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> have opposite signs, i.e., <span class="math inline">\(f(a)f(b) &lt; 0\)</span>.</p>
<p><strong>Step 2.</strong> Compute the midpoint <span class="math inline">\(c = (a+b)/2\)</span>.</p>
<p><strong>Step 3.</strong> Evaluate and check the sign of <span class="math inline">\(f(c)\)</span>. If <span class="math inline">\(f(c)\)</span> has the same sign as <span class="math inline">\(f(a)\)</span>, then set <span class="math inline">\(a=c\)</span>. Otherwise, set <span class="math inline">\(b=c\)</span>.</p>
<p><strong>Step 4.</strong> Iterate Steps 2 and 3 until the interval <span class="math inline">\([a,b]\)</span> is sufficiently small.</p>
</div>
<p>The intuition here is that we are shirking the search space <span class="math inline">\(\chi\)</span> by half in each iteration.</p>
<p>Q: Why this algorithm work and what are the assumptions? 1. We require the function to be continuous 2. We require the function to have opposite signs at the two endpoints <span class="math inline">\(a,b\in\chi\subseteq \mathbb R\)</span>. 3. We do not require the differentiability!</p>
<p>Q: But whatâ€™s the cost?</p>
<p>Q: Can this work for every function?</p>
<section id="example" class="level4" data-number="2.5.3.1">
<h4 data-number="2.5.3.1" class="anchored" data-anchor-id="example"><span class="header-section-number">2.5.3.1</span> Example</h4>
<p>Suppose the design region is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">-</span> <span class="dv">18</span>, <span class="at">from =</span> a, <span class="at">to =</span> b, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>fun_obj <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">-</span> <span class="dv">18</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>my_bisec <span class="ot">&lt;-</span> <span class="cf">function</span>(fun_obj, a, b, <span class="at">tol =</span> <span class="fl">1E-2</span>, <span class="at">ind_draw =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">fun_obj</span>(a) <span class="sc">*</span> <span class="fu">fun_obj</span>(b) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"f(a) and f(b) must have opposite signs!"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> ((b <span class="sc">-</span> a) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">&gt;</span> tol) {</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ind_draw <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw vertical line</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v =</span> c, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Label the iteration above the x-axis</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(c, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">2</span>, <span class="at">labels =</span> iter <span class="sc">+</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">fun_obj</span>(c) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(c)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">fun_obj</span>(a) <span class="sc">*</span> <span class="fu">fun_obj</span>(c) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> c</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>      a <span class="ot">&lt;-</span> c</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  val_x <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  val_fx <span class="ot">&lt;-</span> <span class="fu">fun_obj</span>(val_x)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">root =</span> val_x, <span class="at">f_root =</span> val_fx, <span class="at">iter =</span> iter))</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Run it</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>res_plot <span class="ot">&lt;-</span> <span class="fu">my_bisec</span>(fun_obj, a, b, <span class="at">ind_draw =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>res_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$root
[1] 3.408203

$f_root
[1] 0.09048409

$iter
[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">my_bisec</span>(fun_obj, a, b)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">fun_obj</span>(x), <span class="at">from =</span> a, <span class="at">to =</span> b)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Bisection Method with "</span>, res<span class="sc">$</span>iter, <span class="st">" iterations"</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> res<span class="sc">$</span>root, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(res<span class="sc">$</span>root, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">5</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"Root â‰ˆ "</span>, <span class="fu">round</span>(res<span class="sc">$</span>root, <span class="dv">3</span>)), </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.9</span>, <span class="at">font =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="newton-raphson-method" class="level3" data-number="2.5.4">
<h3 data-number="2.5.4" class="anchored" data-anchor-id="newton-raphson-method"><span class="header-section-number">2.5.4</span> Newton-Raphson method</h3>
<p>The Newton-Raphson method (or simply Newtonâ€™s method) is an iterative numerical method for finding successively better approximations to the roots (or zeroes) of a real-valued function.</p>
<p>Here, we assume that the function <span class="math inline">\(f\)</span> is differentiable. The idea here is to use the Taylor expansion of the function. Suppose we are search a small neighbour of the solution <span class="math inline">\(x \in \mathbb R\)</span>, say <span class="math inline">\(x_j \in \mathbb R\)</span> is a small number. Then Then we first order Taylor series to approximate <span class="math inline">\(f(x_j+h)\)</span> around <span class="math inline">\(x_j\)</span> is <span class="math display">\[
f(x)\approx f(x_j) +  f^\prime(x_j) (x-x_j),
\]</span> where <span class="math inline">\(f^\prime(x) := \partial_x f(x)\)</span> is the first derivative of <span class="math inline">\(f(x)\)</span>. So the root of this approximation can be improved by updating its place to where <span class="math inline">\(f(x_{j+1}) = 0\)</span>.</p>
<p>So if <span class="math inline">\(f(x_j+h)\)</span> is the root, then we have <span class="math display">\[ 0 = f(x_j) + f^\prime(x_j) h \implies h = -\frac{f(x_j)}{f^\prime(x_j)}.\]</span></p>
<p>Then, we can come back to <span class="math inline">\(x_{j+1}= x_j+h\)</span>, and plug the value of <span class="math inline">\(h\)</span> in from above, we have <span class="math display">\[
x_{j+1} = x_j - \frac{f(x_j)}{f^\prime(x_j)}.
\]</span></p>
<p>The algorithm is given as below:</p>
<div class="callout-algorithm" title="Newton-Raphson Method">
<p>Let <span class="math inline">\(f:\mathbb R\to\mathbb R\)</span> be differentiable. Given a current iterate <span class="math inline">\(x_j\)</span> near a root <span class="math inline">\(r\)</span> with <span class="math inline">\(f(r)=0\)</span>, use the first-order Taylor expansion of <span class="math inline">\(f\)</span> at <span class="math inline">\(x_j\)</span>: <span class="math display">\[f(x)\;\approx\; f(x_j) + fâ€™(x_j)\,(x - x_j).\]</span> To obtain the next iterate, set this linear approximation to zero and solve for x: <span class="math display">\[0 \approx f(x_j) + fâ€™(x_j)\,(x - x_j)
\quad\Longrightarrow\quad
x \approx x_j - \frac{f(x_j)}{fâ€™(x_j)}.\]</span> Define <span class="math display">\[\boxed{\,x_{j+1} \;=\; x_j - \dfrac{f(x_j)}{fâ€™(x_j)}\,}.\]</span></p>
<p>Step 0: Choose a function <span class="math inline">\(f(x)\)</span>: This is the function for which you want to find a root (i.e., solve <span class="math inline">\(f(x) = 0)\)</span>.</p>
<p>Step 1: Calculate the derivative <span class="math inline">\(f^\prime(x)\)</span>: You will need it to apply the formula.</p>
<p>Step 2: Make an initial guess <span class="math inline">\(x_0\)</span>: Select a starting point <span class="math inline">\(x_0\)</span> near the expected root.</p>
<p>Step 3: Update the estimate: Use the Newtonâ€™s method formula to compute the next estimate <span class="math inline">\(x_1\)</span> using <span class="math inline">\(x_0\)</span> by <span class="math display">\[x_{j+1} = x_j - \frac{f(x_j)}{f^\prime(x_j)}.\]</span></p>
<p>Step 4: Repeat Steps 2 and 3 until the values converge to a root or reach a desired tolerance.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Function and derivative</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>f  <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">-</span> <span class="dv">18</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">1.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Newtonâ€“Raphson with iterate tracking</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>newton_raphson <span class="ot">&lt;-</span> <span class="cf">function</span>(f, df, x0, <span class="at">tol =</span> <span class="fl">1e-5</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">maxit =</span> <span class="dv">100</span>, <span class="at">eps =</span> <span class="fl">1e-5</span>) {</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x0</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> x0      <span class="co"># store iterates (x0, x1, x2, ...)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxit) {</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    fx  <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    dfx <span class="ot">&lt;-</span> <span class="fu">df</span>(x)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    x_new <span class="ot">&lt;-</span> x <span class="sc">-</span> fx<span class="sc">/</span>dfx</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    xs <span class="ot">&lt;-</span> <span class="fu">c</span>(xs, x_new)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x_new <span class="sc">-</span> x) <span class="sc">&lt;</span> tol <span class="sc">||</span> <span class="fu">abs</span>(fx) <span class="sc">&lt;</span> tol) {</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">root =</span> x_new, <span class="at">iter =</span> k, <span class="at">path =</span> xs))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_new</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">root =</span> x, <span class="at">iter =</span> maxit, <span class="at">path =</span> xs)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Starting point</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we start at -1 which is far away from</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">newton_raphson</span>(f, df, x0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we start at 3 which is near to the point</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">newton_raphson</span>(f, df, x0)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot range that shows the iterates and root</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>; b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">f</span>(x), <span class="at">from =</span> a, <span class="at">to =</span> b, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Newton-Raphson (Iterations:"</span>, res<span class="sc">$</span>iter, <span class="st">")"</span>))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Draw vertical lines for each iterate with labels 0,1,2,...</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(res<span class="sc">$</span>path)) {</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  xi <span class="ot">&lt;-</span> res<span class="sc">$</span>path[i]</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> xi, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(xi, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">2</span>, <span class="at">labels =</span> i <span class="sc">-</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Final root marker + label</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> res<span class="sc">$</span>root, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(res<span class="sc">$</span>root, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">5</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"Root â‰ˆ "</span>, <span class="fu">round</span>(res<span class="sc">$</span>root, <span class="dv">5</span>),</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" ; f(root) â‰ˆ "</span>, <span class="fu">signif</span>(<span class="fu">f</span>(res<span class="sc">$</span>root), <span class="dv">3</span>)),</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.95</span>, <span class="at">font =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$root
[1] 3.402848

$iter
[1] 4

$path
[1] 3.000000 3.461538 3.403866 3.402848 3.402848</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>; b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="fu">f</span>(x), <span class="at">from =</span> a, <span class="at">to =</span> b, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Newton-Raphson (Iterations:"</span>, res<span class="sc">$</span>iter, <span class="st">")"</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Draw vertical lines for each iterate with labels 0,1,2,...</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(res<span class="sc">$</span>path)) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  xi <span class="ot">&lt;-</span> res<span class="sc">$</span>path[i]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> xi, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(xi, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">2</span>, <span class="at">labels =</span> i <span class="sc">-</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Final root marker + label</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> res<span class="sc">$</span>root, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(res<span class="sc">$</span>root, <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">5</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"Root â‰ˆ "</span>, <span class="fu">round</span>(res<span class="sc">$</span>root, <span class="dv">5</span>),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" ; f(root) â‰ˆ "</span>, <span class="fu">signif</span>(<span class="fu">f</span>(res<span class="sc">$</span>root), <span class="dv">3</span>)),</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.95</span>, <span class="at">font =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-optimization_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$root
[1] 3.402848

$iter
[1] 4

$path
[1] 3.000000 3.461538 3.403866 3.402848 3.402848</code></pre>
</div>
</div>
<p>Notes &amp; common pitfalls</p>
<ul>
<li><p>Assumptions: <span class="math inline">\(f\)</span> is differentiable in a neighborhood of the root <span class="math inline">\(r\)</span> and <span class="math inline">\(fâ€™(r)\neq 0\)</span>. Under these and a sufficiently good initial guess, convergence is quadratic.</p></li>
<li><p>Failure cases: if <span class="math inline">\(f^\prime(x_j)=0\)</span> (or is very small), the update is ill-defined/unstable; if the initial guess is far, the method can diverge or jump to a different root.</p></li>
<li><p>Practical checks: stop when <span class="math inline">\(|f(x_j)|\le \delta\)</span> or <span class="math inline">\(|x_{j+1}-x_j| \le \delta\)</span> is below tolerance; cap iterations; guard against tiny <span class="math inline">\(fâ€™(x_j)\)</span>.</p></li>
</ul>
</section>
<section id="second-method" class="level3" data-number="2.5.5">
<h3 data-number="2.5.5" class="anchored" data-anchor-id="second-method"><span class="header-section-number">2.5.5</span> Second Method</h3>
<p>The secant method can be thought of as a finite-difference approximation of Newtonâ€™s method, so it is considered a quasi-Newton method. It is simialr to Newtonâ€™s method, but it does not require the computation of the derivative of the function. Instead, it approximates the derivative using two previous points.</p>
<p>In the second method, we require the <strong>first two point</strong>s, say <span class="math inline">\(x_0, x_1 \in \mathbb R\)</span>. Then, we can approximate the derivative of <span class="math inline">\(f\)</span> at <span class="math inline">\(x_1\)</span> using the finite difference formula. Instead of calculate the derivative <span class="math inline">\(f^\prime(x_1)\)</span>, we approximate it as using the secant line. In calculate, we know that, <span class="math inline">\(f^\prime(x_1) \approx \frac{f(x_1)-f(x_0)}{x_1-x_0}\)</span>, if <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_0\)</span> are close. Then, we can plug this approximation into the Newtonâ€™s update formula to get <span class="math display">\[x_j  = x_{j-1}  - f(x_{j-1}) \frac{x_{j-1}-x_{j-2}}{f(x_{j-1}) - f(x_{j-2})} = \frac{x_{j-2} f\left(x_{j-1}\right)-x_{j-1} f\left(x_{j-2}\right)}{f\left(x_{j-1}\right)-f\left(x_{j-2}\right)} .\]</span></p>
</section>
<section id="multivariate-case" class="level3" data-number="2.5.6">
<h3 data-number="2.5.6" class="anchored" data-anchor-id="multivariate-case"><span class="header-section-number">2.5.6</span> Multivariate Case</h3>
<p>We need to calculate the gradient/Jacobian matrix and Hessian matrix.</p>
</section>
</section>
<section id="heuristic-algorithms" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="heuristic-algorithms"><span class="header-section-number">2.6</span> Heuristic Algorithms</h2>
<p>Many of the heuristic algorithms are inspired by the nature, such as the genetic algorithm (GA) and particle swarm optimization (PSO). These algorithms are often used for complex optimization problems where traditional methods may struggle to find a solution. Some of the popular heuristic algorithms include:</p>
<ul>
<li>Genetic Algorithm (GA)</li>
<li>Particle Swarm Optimization (PSO)</li>
<li>Simulated Annealing (SA)</li>
<li>Ant Colony Optimization (ACO)</li>
</ul>
<section id="in-r" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="in-r"><span class="header-section-number">2.6.1</span> In R</h3>
<p><code>optim()</code> function, <code>nlm()</code> function or <code>mle()</code> function.</p>
</section>
<section id="em-algorithm" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="em-algorithm"><span class="header-section-number">2.6.2</span> EM Algorithm</h3>
<p>The EM (Expectationâ€“Maximization) algorithm is an optimization method that is often applied to find maximum likelihood estimates when data is incomplete or has missing values. It iteratively refines estimates of parameters by alternating between (1) expectation step (E-step) and (2) maximization step (M-step).</p>
<!-- ::: {.callout-note title="Tip with Title"} -->
<!-- For example, consider the function $f(x) = x^2$. -->
<!-- ::: -->
<!-- ::: callout-example -->
<!-- Example -->
<!-- $$ -->
<!-- f(x) = x^2 -->
<!-- $$ -->
<!-- ::: -->
<!-- ::: callout-theorem -->
<!-- Example Theorem -->
<!-- ::: -->
<hr>
<p>Examples are borrowed from the following sources:</p>
<ul>
<li>Peng, R.D. <a href="https://bookdown.org/rdpeng/advstatcomp/">Advanced Statistical Computing</a>.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-intro.html" class="pagination-link" aria-label="Data Structure and R Programming">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Structure and R Programming</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-resampling.html" class="pagination-link" aria-label="Resampling, Jackknife and Bootstrap">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Resampling, Jackknife and Bootstrap</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>